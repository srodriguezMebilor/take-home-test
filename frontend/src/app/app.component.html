<main class="loans">
  <section class="loans--container">
    <h1>Loan Management</h1>

    @if (isLoading) {
      <div style="display: flex; justify-content: center; margin-top: 20px;">
        <mat-spinner diameter="50"></mat-spinner>
      </div>
    } 
    
    @else {
      <table mat-table [dataSource]="loans" class="mat-elevation-z8">
        
        <ng-container matColumnDef="loanAmount">
          <th mat-header-cell *matHeaderCellDef>Loan Amount</th>
          <td mat-cell *matCellDef="let element">
            {{ element.amount | currency }}
          </td>
        </ng-container>

        <ng-container matColumnDef="currentBalance">
          <th mat-header-cell *matHeaderCellDef>Current Balance</th>
          <td mat-cell *matCellDef="let element">
            {{ element.currentBalance | currency }}
          </td>
        </ng-container>

        <ng-container matColumnDef="applicant">
          <th mat-header-cell *matHeaderCellDef>Applicant</th>
          <td mat-cell *matCellDef="let element">{{ element.applicantName }}</td>
        </ng-container>

        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef>Status</th>
          <td mat-cell *matCellDef="let element">{{ element.status }}</td>
        </ng-container>

      <ng-container matColumnDef="actions">
  <th mat-header-cell *matHeaderCellDef> Actions </th>
  <td mat-cell *matCellDef="let element">
    
    @if (element.currentBalance > 0) {
      <button mat-raised-button 
              class="btn-pay"
              (click)="openPayDialog(element)">
        <mat-icon>attach_money</mat-icon>
        Pay
      </button>
    } 
    
    @else {
      <div class="paid-badge">
        <mat-icon>check_circle</mat-icon>
        <span>Paid</span>
      </div>
    }

  </td>
</ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
         <div *ngIf="paymentFormVisible" class="modal">
      <div class="modal-content">
      </div>
    </div>
    }
  </section>
  <button mat-fab color="primary" class="fab-add-btn" (click)="createLoan()">
    <mat-icon>add</mat-icon>
  </button>
</main>